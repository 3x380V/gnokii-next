#!/bin/bash

LOCKFILE="/var/lock/gnokii.lock"
BINARY="/usr/lib/gnokii/gnokii"
TIMEOUT=30

#echo "$0"

if ! dotlockfile -l -p -r 15 $LOCKFILE; then
 echo "gnokii: can't acquire lock" >&2
 RETVAL=127
else
 timeout $TIMEOUT $BINARY "$@"
 RETVAL=$?
 dotlockfile -u $LOCKFILE
fi

exit $RETVAL
